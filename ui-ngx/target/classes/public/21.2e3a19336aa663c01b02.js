(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"4FQJ":function(e,t,l){"use strict";l.r(t),(function(e){l.d(t,"TbCanvasDigitalGauge",(function(){return b}));var i=l("Mpb7"),a=l("Zss7"),o=l("//Q6"),s=l("yWc6"),n=l("QR2c"),u=l("ofXK"),r=l("0lYY"),c=l("3Tyt"),g=l("EY2u"),h=a,d=i.a,b=function(){function t(l,i){this.ctx=l;var a=e("#"+i,l.$container)[0],u=l.settings;this.localSettings={},this.localSettings.minValue=u.minValue||0,this.localSettings.maxValue=u.maxValue||100,this.localSettings.gaugeType=u.gaugeType||"arc",this.localSettings.neonGlowBrightness=u.neonGlowBrightness||0,this.localSettings.dashThickness=u.dashThickness||0,this.localSettings.roundedLineCap=!0===u.roundedLineCap;var r=l.data[0].dataKey,c=u.defaultColor||r.color;this.localSettings.unitTitle=!0===u.showUnitTitle?u.unitTitle&&u.unitTitle.length>0?u.unitTitle:r.label:"",this.localSettings.showTimestamp=!0===u.showTimestamp,this.localSettings.timestampFormat=u.timestampFormat&&u.timestampFormat.length?u.timestampFormat:"yyyy-MM-dd HH:mm:ss",this.localSettings.gaugeWidthScale=u.gaugeWidthScale||.75,this.localSettings.gaugeColor=u.gaugeColor||h(c).setAlpha(.2).toRgbString(),this.localSettings.useFixedLevelColor=u.useFixedLevelColor||!1,u.useFixedLevelColor?(this.localSettings.levelColors=[c],this.localSettings.fixedLevelColors=u.fixedLevelColors||[]):u.levelColors&&0!==u.levelColors.length?this.localSettings.levelColors=u.levelColors.slice():this.localSettings.levelColors=[c],this.localSettings.showTicks=u.showTicks||!1,this.localSettings.ticks=[],this.localSettings.ticksValue=u.ticksValue||[],this.localSettings.tickWidth=u.tickWidth||4,this.localSettings.colorTicks=u.colorTicks||"#666",this.localSettings.decimals=Object(o.n)(r.decimals)?r.decimals:Object(o.o)(u.decimals)?u.decimals:l.decimals,this.localSettings.units=r.units&&r.units.length?r.units:Object(o.n)(u.units)&&u.units.length>0?u.units:l.units,this.localSettings.hideValue=!0!==u.showValue,this.localSettings.hideMinMax=!0!==u.showMinMax,this.localSettings.donutStartAngle=Object(o.o)(u.donutStartAngle)?-t.toRadians(u.donutStartAngle):null,this.localSettings.title=!0===u.showTitle?u.title&&u.title.length>0?u.title:r.label:"",!this.localSettings.unitTitle&&this.localSettings.showTimestamp&&(this.localSettings.unitTitle=" "),this.localSettings.titleFont=Object(s.b)(u.titleFont,{size:12,style:"normal",weight:"500",color:c}),this.localSettings.valueFont=Object(s.b)(u.valueFont,{size:18,style:"normal",weight:"500",color:c}),this.localSettings.minMaxFont=Object(s.b)(u.minMaxFont,{size:10,style:"normal",weight:"500",color:c}),this.localSettings.labelFont=Object(s.b)(u.labelFont,{size:8,style:"normal",weight:"500",color:c});var g={renderTo:a,gaugeWidthScale:this.localSettings.gaugeWidthScale,gaugeColor:this.localSettings.gaugeColor,levelColors:this.localSettings.levelColors,colorTicks:this.localSettings.colorTicks,tickWidth:this.localSettings.tickWidth,ticks:this.localSettings.ticks,title:this.localSettings.title,fontTitleSize:this.localSettings.titleFont.size,fontTitleStyle:this.localSettings.titleFont.style,fontTitleWeight:this.localSettings.titleFont.weight,colorTitle:this.localSettings.titleFont.color,fontTitle:this.localSettings.titleFont.family,fontValueSize:this.localSettings.valueFont.size,fontValueStyle:this.localSettings.valueFont.style,fontValueWeight:this.localSettings.valueFont.weight,colorValue:this.localSettings.valueFont.color,fontValue:this.localSettings.valueFont.family,fontMinMaxSize:this.localSettings.minMaxFont.size,fontMinMaxStyle:this.localSettings.minMaxFont.style,fontMinMaxWeight:this.localSettings.minMaxFont.weight,colorMinMax:this.localSettings.minMaxFont.color,fontMinMax:this.localSettings.minMaxFont.family,fontLabelSize:this.localSettings.labelFont.size,fontLabelStyle:this.localSettings.labelFont.style,fontLabelWeight:this.localSettings.labelFont.weight,colorLabel:this.localSettings.labelFont.color,fontLabel:this.localSettings.labelFont.family,minValue:this.localSettings.minValue,maxValue:this.localSettings.maxValue,gaugeType:this.localSettings.gaugeType,dashThickness:this.localSettings.dashThickness,roundedLineCap:this.localSettings.roundedLineCap,symbol:this.localSettings.units,label:this.localSettings.unitTitle,showTimestamp:this.localSettings.showTimestamp,hideValue:this.localSettings.hideValue,hideMinMax:this.localSettings.hideMinMax,donutStartAngle:this.localSettings.donutStartAngle,valueDec:this.localSettings.decimals,neonGlowBrightness:this.localSettings.neonGlowBrightness,animation:!1!==u.animation&&!l.isMobile,animationDuration:Object(o.o)(u.animationDuration)?u.animationDuration:500,animationRule:u.animationRule||"linear",isMobile:l.isMobile};this.gauge=new n.CanvasDigitalGauge(g).draw(),this.init()}return Object.defineProperty(t,"settingsSchema",{get:function(){return d},enumerable:!1,configurable:!0}),t.generateDatasource=function(e,t,l,i,a){var o=e.aliasController.getEntityAliasId(l);if(!o)throw new Error("Not valid entity aliase name "+l);var s=t.find((function(e){return e.entityAliasId===o})),n={type:c.h.attribute,name:i,label:i,settings:[a],_hash:Math.random()};if(s){var u=s.dataKeys.find((function(e){return e.name===i}));u?u.settings.push(a):s.dataKeys.push(n)}else{var g={type:r.a.entity,name:l,aliasName:l,entityAliasId:o,dataKeys:[n]};t.push(g)}return t},t.toRadians=function(e){return e*(Math.PI/180)},t.prototype.init=function(){var e,t,l=!1;this.localSettings.useFixedLevelColor&&(null===(e=this.localSettings.fixedLevelColors)||void 0===e?void 0:e.length)>0&&(this.localSettings.levelColors=this.settingLevelColorsSubscribe(this.localSettings.fixedLevelColors),l=!0),this.localSettings.showTicks&&(null===(t=this.localSettings.ticksValue)||void 0===t?void 0:t.length)&&(this.localSettings.ticks=this.settingTicksSubscribe(this.localSettings.ticksValue),l=!0),l&&this.updateSetting()},t.prototype.settingLevelColorsSubscribe=function(e){var l=this,i=[],a=[];function o(e,l){if("predefinedValue"===e.valueSource&&isFinite(e.value))a.push({value:e.value,color:l});else if(e.entityAlias&&e.attribute){try{i=t.generateDatasource(this.ctx,i,e.entityAlias,e.attribute,{color:l,index:a.length})}catch(o){return}a.push(null)}}for(var s=0,n=e;s<n.length;s++){var u=n[s];u.from&&o.call(this,u.from,u.color),u.to&&o.call(this,u.to,u.color)}return this.subscribeAttributes(i,"levelColors").subscribe((function(e){l.levelColorsSourcesSubscription=e})),a},t.prototype.settingTicksSubscribe=function(e){for(var l=this,i=[],a=[],o=0,s=e;o<s.length;o++){var n=s[o];if("predefinedValue"===n.valueSource&&isFinite(n.value))a.push(n.value);else if(n.entityAlias&&n.attribute){try{i=t.generateDatasource(this.ctx,i,n.entityAlias,n.attribute,a.length)}catch(u){continue}a.push(null)}}return this.subscribeAttributes(i,"ticks").subscribe((function(e){l.ticksSourcesSubscription=e})),a},t.prototype.subscribeAttributes=function(e,t){var l=this;if(!e.length)return g.a;var i={datasources:e,useDashboardTimewindow:!1,type:r.k.latest,callbacks:{onDataUpdated:function(e){l.updateAttribute(e.data,t)}}};return this.ctx.subscriptionApi.createSubscription(i,!0)},t.prototype.updateAttribute=function(e,t){for(var l=0,i=e;l<i.length;l++){var a=i[l];if(a&&a.data&&a.data[0]){var o=a.data[0][1];if(isFinite(o))for(var s=0,n=a.dataKey.settings;s<n.length;s++){var u=n[s];switch(t){case"levelColors":this.localSettings.levelColors[u.index]={value:o,color:u.color};break;case"ticks":this.localSettings.ticks[u]=o}}}}this.updateSetting()},t.prototype.updateSetting=function(){this.gauge.options.ticks=this.localSettings.ticks,this.gauge.options.levelColors=this.localSettings.levelColors,this.gauge.options=n.CanvasDigitalGauge.configure(this.gauge.options),this.gauge.update({})},t.prototype.update=function(){if(this.ctx.data.length>0){var e=this.ctx.data[0];if(e.data.length>0){var t=e.data[e.data.length-1],l=void 0;if(this.localSettings.showTimestamp){l=t[0];var i=this.ctx.$injector.get(u.DatePipe);this.gauge.options.label=i.transform(l,this.localSettings.timestampFormat)}var a=t[1];a!==this.gauge.value?(this.gauge.options.animation||(this.gauge._value=a),this.gauge.value=a):this.localSettings.showTimestamp&&this.gauge.timestamp!==l&&(this.gauge.timestamp=l)}}},t.prototype.mobileModeChanged=function(){var e=!1!==this.ctx.settings.animation&&!this.ctx.isMobile;this.gauge.update({animation:e,isMobile:this.ctx.isMobile})},t.prototype.resize=function(){this.gauge.update({width:this.ctx.width,height:this.ctx.height})},t}()}).call(this,l("xexB"))},Mpb7:function(e,t,l){"use strict";l.d(t,"a",(function(){return i}));var i={schema:{type:"object",title:"Settings",properties:{minValue:{title:"Minimum value",type:"number",default:0},maxValue:{title:"Maximum value",type:"number",default:100},gaugeType:{title:"Gauge type",type:"string",default:"arc"},donutStartAngle:{title:"Angle to start from when in donut mode",type:"number",default:90},neonGlowBrightness:{title:"Neon glow effect brightness, (0-100), 0 - disable effect",type:"number",default:0},dashThickness:{title:"Thickness of the stripes, 0 - no stripes",type:"number",default:0},roundedLineCap:{title:"Display rounded line cap",type:"boolean",default:!1},title:{title:"Gauge title",type:"string",default:null},showTitle:{title:"Show gauge title",type:"boolean",default:!1},unitTitle:{title:"Unit title",type:"string",default:null},showUnitTitle:{title:"Show unit title",type:"boolean",default:!1},showTimestamp:{title:"Show value timestamp",type:"boolean",default:!1},timestampFormat:{title:"Timestamp format",type:"string",default:"yyyy-MM-dd HH:mm:ss"},showValue:{title:"Show value text",type:"boolean",default:!0},showMinMax:{title:"Show min and max values",type:"boolean",default:!0},gaugeWidthScale:{title:"Width of the gauge element",type:"number",default:.75},defaultColor:{title:"Default color",type:"string",default:null},gaugeColor:{title:"Background color of the gauge element",type:"string",default:null},useFixedLevelColor:{title:"Use precise value for the color indicator",type:"boolean",default:!1},levelColors:{title:"Colors of indicator, from lower to upper",type:"array",items:{title:"Color",type:"string"}},fixedLevelColors:{title:"The colors for the indicator using boundary values",type:"array",items:{title:"levelColor",type:"object",properties:{from:{title:"From",type:"object",properties:{valueSource:{title:"[From] Value source",type:"string",default:"predefinedValue"},entityAlias:{title:"[From] Source entity alias",type:"string"},attribute:{title:"[From] Source entity attribute",type:"string"},value:{title:"[From] Value (if predefined value is selected)",type:"number"}}},to:{title:"To",type:"object",properties:{valueSource:{title:"[To] Value source",type:"string",default:"predefinedValue"},entityAlias:{title:"[To] Source entity alias",type:"string"},attribute:{title:"[To] Source entity attribute",type:"string"},value:{title:"[To] Value (if predefined value is selected)",type:"number"}}},color:{title:"Color",type:"string"}}}},showTicks:{title:"Show ticks",type:"boolean",default:!1},tickWidth:{title:"Width ticks",type:"number",default:4},colorTicks:{title:"Color ticks",type:"string",default:"#666"},ticksValue:{title:"The ticks predefined value",type:"array",items:{title:"tickValue",type:"object",properties:{valueSource:{title:"Value source",type:"string",default:"predefinedValue"},entityAlias:{title:"Source entity alias",type:"string"},attribute:{title:"Source entity attribute",type:"string"},value:{title:"Value (if predefined value is selected)",type:"number"}}}},animation:{title:"Enable animation",type:"boolean",default:!0},animationDuration:{title:"Animation duration",type:"number",default:500},animationRule:{title:"Animation rule",type:"string",default:"linear"},titleFont:{title:"Gauge title font",type:"object",properties:{family:{title:"Font family",type:"string",default:"Roboto"},size:{title:"Size",type:"number",default:12},style:{title:"Style",type:"string",default:"normal"},weight:{title:"Weight",type:"string",default:"500"},color:{title:"color",type:"string",default:null}}},labelFont:{title:"Font of label showing under value",type:"object",properties:{family:{title:"Font family",type:"string",default:"Roboto"},size:{title:"Size",type:"number",default:8},style:{title:"Style",type:"string",default:"normal"},weight:{title:"Weight",type:"string",default:"500"},color:{title:"color",type:"string",default:null}}},valueFont:{title:"Font of label showing current value",type:"object",properties:{family:{title:"Font family",type:"string",default:"Roboto"},size:{title:"Size",type:"number",default:18},style:{title:"Style",type:"string",default:"normal"},weight:{title:"Weight",type:"string",default:"500"},color:{title:"color",type:"string",default:null}}},minMaxFont:{title:"Font of minimum and maximum labels",type:"object",properties:{family:{title:"Font family",type:"string",default:"Roboto"},size:{title:"Size",type:"number",default:10},style:{title:"Style",type:"string",default:"normal"},weight:{title:"Weight",type:"string",default:"500"},color:{title:"color",type:"string",default:null}}}}},form:["minValue","maxValue",{key:"gaugeType",type:"rc-select",multiple:!1,items:[{value:"arc",label:"Arc"},{value:"donut",label:"Donut"},{value:"horizontalBar",label:"Horizontal bar"},{value:"verticalBar",label:"Vertical bar"}]},"donutStartAngle","neonGlowBrightness","dashThickness","roundedLineCap","title","showTitle","unitTitle","showUnitTitle","showTimestamp","timestampFormat","showValue","showMinMax","gaugeWidthScale",{key:"defaultColor",type:"color"},{key:"gaugeColor",type:"color"},"useFixedLevelColor",{key:"levelColors",condition:"model.useFixedLevelColor !== true",items:[{key:"levelColors[]",type:"color"}]},{key:"fixedLevelColors",condition:"model.useFixedLevelColor === true",items:[{key:"fixedLevelColors[].from.valueSource",type:"rc-select",multiple:!1,items:[{value:"predefinedValue",label:"Predefined value (Default)"},{value:"entityAttribute",label:"Value taken from entity attribute"}]},"fixedLevelColors[].from.value","fixedLevelColors[].from.entityAlias","fixedLevelColors[].from.attribute",{key:"fixedLevelColors[].to.valueSource",type:"rc-select",multiple:!1,items:[{value:"predefinedValue",label:"Predefined value (Default)"},{value:"entityAttribute",label:"Value taken from entity attribute"}]},"fixedLevelColors[].to.value","fixedLevelColors[].to.entityAlias","fixedLevelColors[].to.attribute",{key:"fixedLevelColors[].color",type:"color"}]},"showTicks",{key:"tickWidth",condition:"model.showTicks === true"},{key:"colorTicks",condition:"model.showTicks === true",type:"color"},{key:"ticksValue",condition:"model.showTicks === true",items:[{key:"ticksValue[].valueSource",type:"rc-select",multiple:!1,items:[{value:"predefinedValue",label:"Predefined value (Default)"},{value:"entityAttribute",label:"Value taken from entity attribute"}]},"ticksValue[].value","ticksValue[].entityAlias","ticksValue[].attribute"]},"animation","animationDuration",{key:"animationRule",type:"rc-select",multiple:!1,items:[{value:"linear",label:"Linear"},{value:"quad",label:"Quad"},{value:"quint",label:"Quint"},{value:"cycle",label:"Cycle"},{value:"bounce",label:"Bounce"},{value:"elastic",label:"Elastic"},{value:"dequad",label:"Dequad"},{value:"dequint",label:"Dequint"},{value:"decycle",label:"Decycle"},{value:"debounce",label:"Debounce"},{value:"delastic",label:"Delastic"}]},{key:"titleFont",items:["titleFont.family","titleFont.size",{key:"titleFont.style",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"italic",label:"Italic"},{value:"oblique",label:"Oblique"}]},{key:"titleFont.weight",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"bold",label:"Bold"},{value:"bolder",label:"Bolder"},{value:"lighter",label:"Lighter"},{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"},{value:"500",label:"500"},{value:"600",label:"600"},{value:"700",label:"700"},{value:"800",label:"800"},{value:"900",label:"900"}]},{key:"titleFont.color",type:"color"}]},{key:"labelFont",items:["labelFont.family","labelFont.size",{key:"labelFont.style",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"italic",label:"Italic"},{value:"oblique",label:"Oblique"}]},{key:"labelFont.weight",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"bold",label:"Bold"},{value:"bolder",label:"Bolder"},{value:"lighter",label:"Lighter"},{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"},{value:"500",label:"500"},{value:"600",label:"600"},{value:"700",label:"700"},{value:"800",label:"800"},{value:"900",label:"900"}]},{key:"labelFont.color",type:"color"}]},{key:"valueFont",items:["valueFont.family","valueFont.size",{key:"valueFont.style",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"italic",label:"Italic"},{value:"oblique",label:"Oblique"}]},{key:"valueFont.weight",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"bold",label:"Bold"},{value:"bolder",label:"Bolder"},{value:"lighter",label:"Lighter"},{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"},{value:"500",label:"500"},{value:"600",label:"600"},{value:"700",label:"700"},{value:"800",label:"800"},{value:"900",label:"900"}]},{key:"valueFont.color",type:"color"}]},{key:"minMaxFont",items:["minMaxFont.family","minMaxFont.size",{key:"minMaxFont.style",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"italic",label:"Italic"},{value:"oblique",label:"Oblique"}]},{key:"minMaxFont.weight",type:"rc-select",multiple:!1,items:[{value:"normal",label:"Normal"},{value:"bold",label:"Bold"},{value:"bolder",label:"Bolder"},{value:"lighter",label:"Lighter"},{value:"100",label:"100"},{value:"200",label:"200"},{value:"300",label:"300"},{value:"400",label:"400"},{value:"500",label:"500"},{value:"600",label:"600"},{value:"700",label:"700"},{value:"800",label:"800"},{value:"900",label:"900"}]},{key:"minMaxFont.color",type:"color"}]}]}},yWc6:function(e,t,l){"use strict";l.d(t,"a",(function(){return a})),l.d(t,"b",(function(){return o}));var i=l("mrSG");function a(e){var t=e&&e.family?e.family:"Roboto";return"RobotoDraft"===t&&(t="Roboto"),t}function o(e,t){var l=Object(i.a)(Object(i.a)({},t),e||{});return l.family=a(l),l}}}]);